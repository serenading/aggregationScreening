%[sweptStrains, notSweptStrains] = getSweptStrains(method)

%% Function returns a cell array of swept vs. non-swept strains that were imaged in the 2018 aggregation dataset. 
% INPUT
% method: 'conservative' or 'liberal'. 'conservative' classes a strain as
% swept if all four chromosomes (I, IV, V or X) are swept (>=30% of the
% same haplotype). 'liberal' classes a strain as swept if any of the four
% chromosomes are swept.

method = 'liberal';
%% Load haplotype data
fpath = '/Users/sding/OneDrive - Imperial College London/aggScreening/source/AndersenLab/sweep_summary_20200815.tsv';
hapshares = tdfread(fpath);

%% Get swept strains master list
if strcmp(method,'conservative')
    sweptMasterLogInd = hapshares.swept_chroms==4;
elseif strcmp(method,'liberal')
    sweptMasterLogInd = hapshares.swept_chroms>=1;
else
    warning('Please specify method as conservative or liberal')
end
% find all swept strains from the Andersen lab list
sweptStrains_master = cellstr(hapshares.isotype(sweptMasterLogInd,:));

%% Get list of swept vs. non-swept strains that were imaged in the dataset
load('strainsList/all.mat')
sweptLogInd = false(numel(strains),1);
for strainCtr = 1:numel(strains)
    strain = strains(strainCtr);
    if ismember(strain,sweptStrains_master)
        sweptLogInd(strainCtr) = true;
    end
end
sweptStrains = strains(sweptLogInd);
nonSweptStrains = strains(~sweptLogInd);
save('strainsList/